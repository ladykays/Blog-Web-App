<%- include("partials/header.ejs") %>

<section class="container-fluid main-content">
  <h1>Edit Post</h1>  

  <div>
    <form action="/posts/update/<%= postId %>" method="POST">
      <div class="mb-3">
        <label for="title" class="form-label">Post Title</label>
        <input type="text" class="form-control" id="title" name="title" required value="<%= postTitle %>" >
      </div>
      <div class="mb-3">
        <label for="category" class="form-label">Category</label>
        <select id="category" name="category" class="form-control">
          <option value="" disabled selected>Select a category</option>
          <option value="family">Family</option>
          <option value="finance">Finance</option>
          <option value="health">Health</option>
          <option value="home">Home</option>
          <option value="lifestyle">Lifestyle</option>
          <option value="mindfulness">Mindfulness</option>
          <option value="parenting">Parenting</option>
          <option value="personal-development">Personal Development</option>
          <option value="productivity">Productivity</option>
          <option value="relationships">Relationships</option>
          <option value="self-care">Self Care</option>
          <option value="work-life-balance">Work-Life Balance</option>
        </select>
      </div>
      <div class="mb-3">
        <label for="image" class="form-label">Cover Image URL</label>
        <input 
          type="url" 
          class="form-control" 
          id="image" 
          name="image" 
          value="<%= postImage === '/images/default.jpg' ? '' : postImage %>" 
          <%# placeholder="Leave empty to use default image" %>
        >
        <small class="form-text text-muted">
          Current image: 
          <% if (postImage === '/images/default.jpg') { %>
            (using default image)
          <% } else { %>
            <img src="<%= postImage %>" width="100">
          <% } %>
        </small>
      </div>
      <div class="mb-3">
        <label for="content" class="form-label">Post Content</label>
        <textarea class="form-control" id="content" name="content" rows="5" required><%= postContent %></textarea>
      </div>
      <div class="mt-5">
        <button type="submit" class="btn btn-warning btn-lg publish-btn">Update Post</button>
      </div>
      
    </form>
  </div>
</section>
<script>
  // Preselect the category in the dropdown
  document.addEventListener('DOMContentLoaded', function() {
    const categorySelect = document.getElementById('category');
    if (categorySelect && '<%= postCategory %>') {
      categorySelect.value = '<%= postCategory %>';
    }
  });
</script>
<%- include("partials/footer.ejs") %>